# 週間予定管理アプリケーション 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
週間予定管理アプリケーション

### 1.2 背景・目的
現在ホワイトボードと紙の「搬入申請依頼書」で行っている週間予定の管理をデジタル化する。チーム全員がPCやスマートフォンから、いつでもどこでも最新の予定を確認・登録・更新できる環境を構築し、業務の効率化と情報共有の円滑化を目指す。

### 1.3 対象ユーザー
- 社内チームメンバー（一般ユーザー・管理者）

## 2. システム要件

### 2.1 技術スタック
- **フロントエンド**: Next.js (App Router)
- **バックエンド**: Supabase (PostgreSQL, Auth, Storage)
- **UI/CSS**: React, Tailwind CSS
- **デプロイ**: Vercel 予定

### 2.2 対応デバイス
- PC（デスクトップ）
- スマートフォン
- レスポンシブデザイン対応

### 2.3 タイムゾーン
- 日本時間（JST）統一

## 3. 機能要件

### 3.1 認証機能
- メールアドレス・パスワードによるログイン
- Supabase Authを使用
- ログアウト機能

### 3.2 ユーザー管理
- **一般ユーザー（role: user）**
  - 自分の予定の登録・更新・削除
  - 全ての予定の閲覧
- **管理者（role: admin）**
  - 全ての予定の登録・更新・削除・閲覧

### 3.3 予定管理機能
#### 3.3.1 予定登録
以下の項目を入力可能：
- 得意先名（必須）
- 開始日時（必須）
- 終了日時（任意）
- 現場名（必須）
- 現場住所（必須）
- 搬入商品・数量（必須）
- 担当者同行の有無（必須）
- アルバイトの有無・人数・時間（任意）
- 運送区分（必須）
- 備考（任意）

#### 3.3.2 予定表示
- 週間カレンダー形式での表示
- PC: 7列の週間レイアウト
- スマートフォン: 1列のリスト形式
- 予定カードに表示する情報：
  - 時間
  - 得意先名
  - 現場名
  - 担当者名
  - 同行/アルバイト有無のアイコン

#### 3.3.3 予定編集・削除
- 自分が登録した予定の編集・削除（一般ユーザー）
- 全ての予定の編集・削除（管理者）
- モーダルダイアログでの編集画面

### 3.4 通知機能
- **通知方法**: メール通知
- **通知タイミング**: リアルタイム
- **通知対象**: チーム全員
- **通知イベント**:
  - 新規予定追加時
  - 予定変更時
  - 予定削除時

### 3.5 カレンダー操作
- 週の移動（前週・次週ボタン）
- 当日へのジャンプ機能

## 4. データベース設計

### 4.1 users テーブル（担当者）
| カラム名 | データ型 | 制約 | 説明 |
|---------|----------|------|------|
| id | UUID | PRIMARY KEY | Supabase AuthのユーザーIDと連携 |
| full_name | VARCHAR(255) | NOT NULL | 担当者の氏名 |
| role | VARCHAR(50) | NOT NULL | ユーザーの役割（'admin' または 'user'） |

### 4.2 tasks テーブル（予定）
| カラム名 | データ型 | 制約 | 説明 |
|---------|----------|------|------|
| id | INTEGER | PRIMARY KEY | 自動採番 |
| user_id | UUID | NOT NULL, FK | 登録者ID（users.id） |
| customer_name | VARCHAR(255) | NOT NULL | 得意先名 |
| start_datetime | TIMESTAMPTZ | NOT NULL | 開始日時 |
| end_datetime | TIMESTAMPTZ | NULL | 終了日時 |
| site_name | VARCHAR(255) | NOT NULL | 現場名 |
| site_address | TEXT | NOT NULL | 現場住所 |
| goods_description | TEXT | NOT NULL | 搬入商品・数量 |
| is_staff_accompanied | BOOLEAN | NOT NULL | 担当者同行の有無 |
| has_part_timer | BOOLEAN | DEFAULT FALSE | アルバイトの有無 |
| part_timer_count | INTEGER | NULL | アルバイトの人数 |
| part_timer_duration | VARCHAR(50) | NULL | アルバイトの時間 |
| transport_method | VARCHAR(50) | NOT NULL | 運送区分 |
| remarks | TEXT | NULL | 備考 |
| created_at | TIMESTAMPTZ | DEFAULT NOW() | 作成日時 |

## 5. セキュリティ要件

### 5.1 認証・認可
- Supabase Authによる認証
- Row Level Security (RLS) によるデータアクセス制御

### 5.2 データアクセス制御
- **一般ユーザー**: 自分の予定のみ編集・削除可能、全予定閲覧可能
- **管理者**: 全ての操作が可能

## 6. UI/UX要件

### 6.1 デザインコンセプト
- クリーン＆シンプル
- 見やすさと分かりやすさを最優先

### 6.2 配色
- 白を基調
- メインカラー: 青系
- アクセントカラー: 予定の種類による色分け

### 6.3 レスポンシブデザイン
- PC・スマートフォン両対応
- Tailwind CSSを使用

## 7. 画面構成

### 7.1 ログイン画面（/login）
- アプリロゴ
- メールアドレス・パスワード入力欄
- ログインボタン

### 7.2 メイン画面（/）
- ヘッダー（週移動ボタン、新規予定追加ボタン、ユーザーメニュー）
- 週間カレンダー表示
- 予定カード

### 7.3 予定登録・編集フォーム
- 新規登録: 専用ページ（/tasks/new）
- 編集: モーダルダイアログ
- 全項目入力フォーム
- 保存・削除ボタン

## 8. 非機能要件

### 8.1 不要な機能（明確に除外）
- データ検索・フィルタリング機能
- 既存データの移行機能
- 印刷機能
- 月表示・日表示への切り替え
- 外部ユーザー（お客様等）のアクセス機能
- 特別なバックアップ・復旧機能

### 8.2 パフォーマンス
- レスポンス時間: 3秒以内
- 同時接続ユーザー数: 20名程度想定

### 8.3 可用性
- Supabase・Vercelのサービス可用性に依存

## 9. 開発・運用

### 9.1 開発フェーズ
1. **プロジェクト初期化・環境設定**
   - Next.jsプロジェクト作成
   - Tailwind CSS導入・設定
   - 基本ディレクトリ構造の作成
   - Git初期化

2. **UI/UX実装（モックアップ・デザインシステム構築）**
   - デザインシステム（色、フォント、コンポーネント）定義
   - ログイン画面のモックアップ・実装
   - メイン画面（週間カレンダー）のモックアップ・実装
   - 予定カードコンポーネントの実装
   - 予定登録・編集フォームのモックアップ・実装
   - レスポンシブデザインの調整

3. **データベース・認証システム構築**
   - Supabaseプロジェクト作成
   - データベーステーブル設計・作成（users, tasks）
   - Row Level Security（RLS）ポリシー設定
   - Supabase Auth設定
   - 認証機能実装（ログイン・ログアウト）

4. **基本CRUD機能実装**
   - 予定一覧表示機能
   - 予定登録機能
   - 予定編集機能
   - 予定削除機能
   - ユーザー権限制御実装

5. **通知機能実装**
   - メール通知システムの設計
   - 予定変更時の通知トリガー実装
   - 通知テンプレート作成

6. **テスト・デバッグ**
   - 機能テスト
   - レスポンシブデザインテスト
   - 権限制御テスト
   - 通知機能テスト

7. **デプロイ・運用開始**
   - Vercelにデプロイ設定
   - 本番環境テスト
   - ユーザートレーニング・引き継ぎ

### 9.2 保守・運用
- 基本的なSupabase・Vercelの管理画面での運用
- 特別な監視・バックアップシステムは導入しない

---

**作成日**: 2025年8月11日  
**バージョン**: 1.0